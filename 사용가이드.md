# IMDB Rating & Metascore 스크래핑 가이드

## 📋 개요
이 스크립트는 TV 시리즈 데이터에서 조건에 맞는 항목들의 IMDB rating과 Metascore를 자동으로 스크래핑합니다.

## 📦 필요한 것

### 1. Python 라이브러리
```bash
pip install pandas requests beautifulsoup4 tqdm
```

### 2. CSV 파일
- `tv_series_2005_2015_FULL.csv`
- `tv_seasons_2005_2015_FULL.csv`

## 🚀 사용 방법

### 기본 버전 (imdb_scraper.py)
```bash
python imdb_scraper.py
```

### 개선된 버전 (imdb_scraper_improved.py) ⭐ 추천
```bash
python imdb_scraper_improved.py
```

**개선된 버전의 장점:**
- 재시도 로직 (네트워크 오류 시 자동 재시도)
- 더 강력한 HTML 파싱 (여러 방법 시도)
- 진행 상황 확인 프롬프트
- 상세한 통계 출력
- 50개마다 중간 저장

## 📊 출력 파일

### imdb_ratings_metascores.csv
최종 결과 파일로 다음 컬럼을 포함합니다:

| 컬럼명 | 설명 |
|--------|------|
| imdb_id | IMDB ID (예: tt0944947) |
| series_name | 시리즈 이름 |
| original_vote_count | 원본 데이터의 투표 수 |
| imdb_rating | IMDB 평점 (예: 7.7) |
| metascore | Metascore 점수 (예: 73) |
| url | IMDB URL |
| status | 처리 상태 (success/error) |

### imdb_scraping_temp.csv
중간 저장 파일 (50개마다 자동 저장)

## ⚙️ 스크립트 작동 원리

1. **필터링**: `vote_count >= 30`이고 `imdb_id`가 존재하는 시리즈만 선택
2. **URL 생성**: 각 IMDB ID로 URL 생성 (`https://www.imdb.com/title/{imdb_id}/`)
3. **HTML 파싱**: BeautifulSoup으로 페이지 파싱
4. **데이터 추출**:
   - IMDB Rating: `<span class="sc-4dc495c1-1">7.7</span>`
   - Metascore: `<span class="sc-9fe7b0ef-0">73</span>`
5. **저장**: 결과를 CSV로 저장

## 🔧 주요 기능

### 재시도 로직
- 네트워크 오류 시 최대 3번 재시도
- 재시도 간격: 2초, 4초, 6초

### 지연 시간
- 각 요청 사이 1-2초 랜덤 딜레이
- 서버 부담 최소화

### 에러 처리
- 네트워크 오류
- 파싱 오류
- 타임아웃
모든 오류를 기록하고 계속 진행

### 중간 저장
- 50개마다 자동 저장
- 프로그램이 중단되어도 진행 상황 유지

## 📈 예상 소요 시간

- 100개 시리즈: 약 2.5분
- 500개 시리즈: 약 12.5분
- 1000개 시리즈: 약 25분

## ⚠️ 주의사항

1. **HTML 구조 변경**: IMDB가 웹사이트 구조를 변경하면 클래스명이 바뀔 수 있습니다.
   - 개선된 버전은 여러 방법을 시도하여 이 문제를 완화합니다.

2. **Metascore 누락**: 모든 시리즈가 Metascore를 가지고 있는 것은 아닙니다.
   - 이는 정상이며, 해당 필드가 None으로 저장됩니다.

3. **네트워크 제한**: 너무 빠르게 요청하면 IP가 차단될 수 있습니다.
   - 스크립트는 적절한 지연을 포함하고 있습니다.

4. **저작권**: 스크래핑한 데이터는 개인적인 용도로만 사용하세요.

## 🐛 문제 해결

### "Connection refused" 오류
- 네트워크 연결 확인
- VPN 사용 시 비활성화 시도
- 프록시 설정 확인

### "Rate limit" 오류
- 지연 시간을 늘려보세요 (코드에서 `time.sleep()` 값 증가)
- 잠시 기다렸다가 다시 시도

### 클래스명을 찾을 수 없음
- IMDB가 HTML 구조를 변경했을 수 있습니다
- 웹사이트를 직접 확인하여 새로운 클래스명을 찾으세요
- 개발자 도구 (F12)로 HTML 구조 확인

## 💡 팁

1. **소규모 테스트**: 먼저 적은 수의 시리즈로 테스트해보세요
   ```python
   df_filtered = df_filtered.head(10)  # 처음 10개만
   ```

2. **재개**: 중단된 경우 temp 파일에서 이미 처리된 항목을 제외하고 재시작
   ```python
   temp_df = pd.read_csv('imdb_scraping_temp.csv')
   processed_ids = temp_df['imdb_id'].tolist()
   df_filtered = df_filtered[~df_filtered['imdb_id'].isin(processed_ids)]
   ```

3. **수동 확인**: 의심스러운 결과는 URL을 직접 방문하여 확인

## 📞 문의

문제가 발생하면 다음을 확인하세요:
1. Python 버전 (3.7 이상 권장)
2. 라이브러리 버전
3. CSV 파일 형식
4. 네트워크 연결

---

**마지막 업데이트**: 2024
**버전**: 2.0
